<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trig with JS</title>
</head>
<body>

<canvas id="myCanvas"
        width="500px" height="500px"
        style="background-color: white">
</canvas>

<br>
<br>

<canvas id="chartCanvas"
        width="500px" height="100px"
        style="background-color: white">
</canvas>

<style>
  body{
    background-color: black;
    margin: 0;
    overflow: hidden;
  }
</style>

<script>
  //Creates new canvas
  const ctx=myCanvas.getContext("2d");
  const chartCtx=chartCanvas.getContext("2d");

  // Creates offset so that points are in the middle of the canvas and easier to see
  const offset={
    x:myCanvas.width/2,
    y:myCanvas.height/2
  };

  const chartOffset={
    x:chartCanvas.width/2,
    y:chartCanvas.height/2
  };

  //Set point values
  const A={x:0, y:0};
  const B={x:90, y:120};
  const C={x:B.x, y:0};

  // Translates the offset
  ctx.translate(offset.x, offset.y);
  chartCtx.translate(chartOffset.x, chartOffset.y);

  drawCoordinateSystem(chartCtx, chartOffset);

  // Call update function so that screen is not blank initially
  update();

  // Add event listener for mouse move
  document.onmousemove=(event)=>{
    B.x=event.x-offset.x;
    B.y=event.y-offset.y;

    C.x=B.x;

    update();
  }
  // Refresh everytime we move our mouse
  function update() {
    //Find the distance between two points
    const c = distance(A, B);
    const a = distance(B, C);
    const b = distance(A, C);

    // Adding the sin function
    const sin=a/c;
    const cos=b/c;
    const tan=sin/cos; // essentially a/b
    const theta=Math.asin(sin);

    ctx.clearRect(-offset.x, -offset.y, myCanvas.width, myCanvas.height);

    // Draw the x,y coordinate system
    drawCoordinateSystem(ctx, offset);

    //draw sine text
    drawText(
    "sin = a/c = "+sin.toFixed(2),
      {x:-offset.x/2,y:offset.y*0.7},
      "red"
    );

    //cosine
    drawText(
      "cos = b/c = "+cos.toFixed(2),
      {x:-offset.x/2,y:offset.y*0.8},
      "blue"
    );

    //tangent
    drawText(
      "tan = a/b = "+tan.toFixed(2),
      {x:-offset.x/2,y:offset.y*0.9},
      "magenta"
    );

    //draw theta text
    drawText(
      "0 = "+theta.toFixed(2)+" ("+
      Math.round(toDeg(theta)).toString().padStart(2," ")+"Â°)",
      {x:offset.x/2,y:offset.y*0.7}
    );

    // Draw lines between the points to create a triangle and create text labels
    drawLine(A, B);
    drawText("c", average(A, B));
    drawLine(A, C), "blue";
    drawText("b", average(A, C), "blue");
    drawLine(B, C), "red";
    drawText("a", average(B, C), "red");

    drawText("0", A);

    // Draw arc
    ctx.beginPath();
    ctx.strokeStyle="black";
    ctx.lineWidth=2;
    const start=B.x>A.x?0:Math.PI;
    const clockwise=B.y<C.y^B.x>A.x;
    let end=B.y<C.y?-theta:theta;
    if(B.x<A.x){
      end=Math.PI-end;
    }
    ctx.arc(0,0,20,start,end,!clockwise);
    ctx.stroke();

    // Draws point on chart and scales it so it can actually be seen since it is a very low set of numbers
    const chartScaler=chartOffset.y*0.5;
    drawPoint({
      x:theta*chartScaler,
      y:sin*chartScaler
    },2,"red");

    drawPoint({
      x:theta*chartScaler,
      y:cos*chartScaler
    },2,"blue");

    drawPoint({
      x:theta*chartScaler,
      y:tan*chartScaler
    },2,"magenta");
  }

  // Function to calculate degrees
  function toDeg(rad){
    return rad*180/Math.PI;
  }

  // Functions for average and distance to add to text labels
  function average(p1,p2){
    return{
      x:(p1.x+p2.x)/2,
      y:(p1.y+p2.y)/2
    };
  }
 // Length of the hypotenuse
  function distance(p1,p2) {
    return Math.hypot(p1.x-p2.x,p1.y-p2.y);
  }
  // Add Text to Points so it is clearer where they are
  function drawText(text,loc,color="black") {
    ctx.beginPath();
    ctx.fillStyle=color;
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.font="bold 18px Courier";
    ctx.strokeStyle="white";
    ctx.lineWidth=7;
    ctx.strokeText(text,loc.x,loc.y);
    ctx.fillText(text,loc.x,loc.y);
  }

  // Function to create individual points
  function drawPoint(loc,size=20,color="black") {
    chartCtx.beginPath();
    chartCtx.fillStyle = color;
    chartCtx.arc(loc.x, loc.y, size/2, 0, Math.PI * 2);
    chartCtx.fill();
  }

  // Function to draw lines from point to point
  function drawLine(p1, p2, color="black") {
    ctx.beginPath();
    ctx.strokeStyle=color;
    ctx.lineWidth=2;
    ctx.moveTo(p1.x,p1.y);
    ctx.lineTo(p2.x,p2.y);
    ctx.stroke();
  }

  // Function to draw x,y coordinate system
  function drawCoordinateSystem(ctx,offset) {
    ctx.beginPath();
    ctx.moveTo(-offset.x, 0);
    ctx.lineTo(ctx.canvas.width - offset.x, 0);
    ctx.moveTo(0, -offset.y);
    ctx.lineTo(0, ctx.canvas.height - offset.y);
    ctx.setLineDash([4, 2]);
    ctx.lineWidth = 1;
    ctx.strokeStyle = "gray";
    ctx.stroke();
    ctx.setLineDash([]);
  }

</script>
</body>
</html>